---
layout: default
title: Transit Map
permalink: project/mapbox/
--- 
<div class="blurb"> 
    <h2><a href="/project"> <-Back to Dashboard </a></h2>
<div id="map" style="width: 100%; height: 600px;"></div>

<link href='https://api.mapbox.com/mapbox-gl-js/v3.14.0/mapbox-gl.css' rel='stylesheet' />
<script src='https://api.mapbox.com/mapbox-gl-js/v3.14.0/mapbox-gl.js'></script>

<script>
mapboxgl.accessToken = 'pk.eyJ1IjoiamdvYmF0MTMiLCJhIjoiY21nMnVtcTh6MTQ4bDJrb2puczF6dWoyeCJ9.6hqHyL74X4bJhjYJXvo9WQ';

const map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/jgobat13/cmidr44cy007r01r985yx1icu', // Your style URL with layers
    center: [-122.3328 , 47.6061], // Adjust to your area
    zoom: 10
});

// Wait for the map to load
map.on('load', () => {
    console.log('Map loaded successfully');
    
    // Check if your layers exist
    const style = map.getStyle();
    console.log('All layers:', style.layers.map(layer => layer.id));
    
    // Check specific layers
    const routesLayer = map.getLayer('TransitRoutes');
    const stopsLayer = map.getLayer('TransitStops');
    const polygonsLayer = map.getLayer('CensusTracts');
    
    console.log('Routes layer exists:', !!routesLayer);
    console.log('Stops layer exists:', !!stopsLayer);
    console.log('Polygons layer exists:', !!polygonsLayer);


    map.on('load', () => {
    
    // TEST WITH CLICK - easier to debug
    map.on('click', 'jgobat13.dnaltwuu', (e) => {
        console.log('Route clicked!');
        console.log('Feature properties:', e.features[0].properties);
        
        const features = e.features[0].properties;
        const popupContent = `
            <strong>Agency:</strong> ${features.agency_name}<br>
            <strong>Route:</strong> ${features.route_desc}<br>
            <strong>URL:</strong> <a href="${features.route_url}" target="_blank">More Info</a>
        `;
        
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(popupContent)
            .addTo(map);
    
    // TRANSIT ROUTES - Hover popup
    map.on('mousemove', 'jgobat13.dnaltwuu', (e) => {
        map.getCanvas().style.cursor = 'pointer';
        
        const features = e.features[0].properties;
        const popupContent = `
            <strong>Agency:</strong> ${features.agency_name}<br>
            <strong>Route:</strong> ${features.route_long_name}<br>
            <strong>Route Line:</strong> ${features.route_short_name}</br>
            <strong>Route Description:</strong> ${features.route_desc}</br>
            <strong>URL:</strong> <a href="${features.route_url}" target="_blank">More Info</a>
        `;
        
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(popupContent)
            .addTo(map);
    });
    
    map.on('mouseleave', 'jgobat13.dnaltwuu', () => {
        map.getCanvas().style.cursor = '';
    });
    
    // TRANSIT STOPS - Hover popup
    map.on('mousemove', 'jgobat13.3sdsuv44', (e) => {
        map.getCanvas().style.cursor = 'pointer';
        
        const features = e.features[0].properties;
        
        const popupContent = `
            <strong>Stop ID:</strong> ${features.stop_id}<br>
            <strong>Stop URL:</strong> ${features.stop_url}
        `;
        
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(popupContent)
            .addTo(map);
    });
    
    map.on('mouseleave', 'jgobat13.3sdsuv44', () => {
        map.getCanvas().style.cursor = '';
    });
    
    // DEMOGRAPHIC POLYGONS - Hover popup
    map.on('mousemove', 'jgobat13.4fp8md9p', (e) => {
        map.getCanvas().style.cursor = 'pointer';
        
        const features = e.features[0].properties;
        // Adjust these property names to match your actual demographic data fields
        const popupContent = `
            <strong>Population:</strong> ${features.population}<br>
            <strong>Median Income:</strong> $${features.median_income}<br>
            <strong>Other Data:</strong> ${features.other_field}
        `;
        
        new mapboxgl.Popup()
            .setLngLat(e.lngLat)
            .setHTML(popupContent)
            .addTo(map);
    });
    
    map.on('mouseleave', 'jgobat13.4fp8md9p', () => {
        map.getCanvas().style.cursor = '';
    });
});
</script>
